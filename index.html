
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>儿童能力测评报告</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: "Microsoft YaHei", sans-serif;
      padding: 20px;
    }
    .report-container {
      width: 700px;
      margin: 0 auto;
    }
    #chart {
      width: 600px;
      height: 500px;
      margin: 0 auto;
    }
    .section {
      margin-top: 20px;
    }
    .bold {
      font-weight: bold;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
    }
  </style>
</head>
<body>
<div class="report-container" id="report">
  <div class="section">
    <label>幼儿园：</label>
    <span id="school-name">一二三幸福力</span><br>
    <label>儿童姓名：</label>
    <span id="child-name">浦斌</span>
  </div>
  <div class="section" id="scores">
    <p><span class="bold">记忆力 (Z=-0.77)：</span>记忆力发展正常，可通过规律重复和趣味游戏巩固。</p>
    <p><span class="bold">语言 (Z=-0.15)：</span>语言能力一般，建议每天固定时间对话与阅读。</p>
    <p><span class="bold">数学 (Z=-0.14)：</span>数学能力中等，建议多接触分类、排序和数字活动。</p>
    <p><span class="bold">延迟满足 (Z=2.18)：</span>具备良好自控力，可引导完成更长时间任务。</p>
    <p><span class="bold">灵活性 (Z=2.16)：</span>认知灵活性佳，适合多任务转换与变换练习。</p>
  </div>
  <div class="section">
    <div id="chart"></div>
  </div>
</div>
<div style="text-align:center;">
  <button onclick="exportPDF()">导出PDF报告</button>
</div>

<script>
  const chart = echarts.init(document.getElementById('chart'));
  const option = {
    title: {
      text: '浦斌 的能力图',
      left: 'center'
    },
    radar: {
      indicator: [
        { name: '记忆力', max: 2.5, min: -2.5 },
        { name: '语言', max: 2.5, min: -2.5 },
        { name: '数学', max: 2.5, min: -2.5 },
        { name: '延迟满足', max: 2.5, min: -2.5 },
        { name: '灵活性', max: 2.5, min: -2.5 }
      ]
    },
    series: [{
      type: 'radar',
      data: [{
        value: [-0.77, -0.15, -0.14, 2.18, 2.16],
        name: '能力'
      }]
    }]
  };
  chart.setOption(option);

  async function exportPDF() {
    const { jsPDF } = window.jspdf;
    const reportEl = document.getElementById("report");
    const canvas = await html2canvas(reportEl, { scale: 2 });
    const imgData = canvas.toDataURL('image/jpeg', 1.0);
    const pdf = new jsPDF('p', 'mm', 'a4');
    const imgProps = pdf.getImageProperties(imgData);
    const pdfWidth = pdf.internal.pageSize.getWidth() - 20;
    const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
    pdf.addImage(imgData, 'JPEG', 10, 10, pdfWidth, pdfHeight);
    const school = document.getElementById("school-name").textContent;
    const name = document.getElementById("child-name").textContent;
    pdf.save(`${school}_${name}.pdf`);
  }
</script>
</body>
</html>
